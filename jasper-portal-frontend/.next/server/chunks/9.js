"use strict";exports.id=9,exports.ids=[9],exports.modules={1012:(e,s,t)=>{t.d(s,{h4:()=>O}),t(7676);var a=t(326),r=t(9635),i=t(7577),l=t(5047),n=t(1821),c=t(5265),o=t(4061),d=t(617),p=t(949),m=t(8019),x=t(6507),u=t(361),h=t(7506),f=t(2933),j=t(4019),b=t(1223);let g="http://127.0.0.1:8000";async function y(){try{let e=await fetch(`${g}/api/v1/notifications`,{method:"GET",headers:{"Content-Type":"application/json","X-User-Id":"admin"}});if(!e.ok)throw Error("Failed to fetch notifications");let s=await e.json();if(s.success&&s.notifications)return s.notifications.map(e=>({...e,timestamp:new Date(e.timestamp)}));return[]}catch(e){return console.error("Error fetching notifications:",e),[]}}async function N(e){try{return(await fetch(`${g}/api/v1/notifications`,{method:"PATCH",headers:{"Content-Type":"application/json","X-User-Id":"admin"},body:JSON.stringify({action:"mark-read",notificationId:e})})).ok}catch(e){return console.error("Error marking notification read:",e),!1}}async function v(){try{return(await fetch(`${g}/api/v1/notifications`,{method:"PATCH",headers:{"Content-Type":"application/json","X-User-Id":"admin"},body:JSON.stringify({action:"mark-all-read"})})).ok}catch(e){return console.error("Error marking all notifications read:",e),!1}}async function w(e){try{return(await fetch(`${g}/api/v1/notifications`,{method:"DELETE",headers:{"Content-Type":"application/json","X-User-Id":"admin"},body:JSON.stringify({notificationId:e})})).ok}catch(e){return console.error("Error deleting notification:",e),!1}}async function k(){try{return(await fetch(`${g}/api/v1/notifications`,{method:"DELETE",headers:{"Content-Type":"application/json","X-User-Id":"admin"},body:JSON.stringify({clearAll:!0})})).ok}catch(e){return console.error("Error clearing notifications:",e),!1}}let Z=e=>{switch(e){case"invoice":return n.Z;case"project":return c.Z;case"client":return o.Z;case"message":return d.Z;case"alert":return p.Z;default:return m.Z}},C=(e,s)=>{if("high"===s)return"text-red-500 bg-red-50";switch(e){case"invoice":return"text-green-600 bg-green-50";case"project":return"text-blue-600 bg-blue-50";case"client":return"text-purple-600 bg-purple-50";case"message":return"text-jasper-emerald bg-jasper-emerald/10";case"alert":return"text-amber-600 bg-amber-50";default:return"text-jasper-slate bg-surface-secondary"}},E=e=>{let s=new Date().getTime()-e.getTime(),t=Math.floor(s/6e4),a=Math.floor(s/36e5),r=Math.floor(s/864e5);return t<1?"Just now":t<60?`${t}m ago`:a<24?`${a}h ago`:r<7?`${r}d ago`:(0,b.p6)(e.toISOString())};function $(){let[e,s]=(0,i.useState)(!1),[t,r]=(0,i.useState)([]),[n,c]=(0,i.useState)(!0),o=(0,i.useRef)(null),d=(0,l.useRouter)();(0,i.useCallback)(async()=>{c(!0),r(await y()),c(!1)},[]);let p=t.filter(e=>!e.isRead).length,m=async e=>{r(s=>s.map(s=>s.id===e?{...s,isRead:!0}:s)),N(e)},g=async()=>{r(e=>e.map(e=>({...e,isRead:!0}))),v()},$=async e=>{r(s=>s.filter(s=>s.id!==e)),w(e)},S=async()=>{r([]),s(!1),k()},L=(0,i.useCallback)(e=>{m(e.id),e.link&&d.push(e.link),s(!1)},[d]);return(0,a.jsxs)("div",{className:"relative",ref:o,children:[(0,a.jsxs)("button",{onClick:()=>s(!e),"aria-label":`Notifications${p>0?` (${p} unread)`:""}`,"aria-expanded":e,"aria-haspopup":"true",className:(0,b.cn)("relative p-2 rounded-lg transition-colors",e?"bg-jasper-emerald/10 text-jasper-emerald":"text-jasper-slate hover:bg-surface-secondary"),children:[a.jsx(x.Z,{className:"w-5 h-5","aria-hidden":"true"}),p>0&&a.jsx("span",{className:"absolute -top-0.5 -right-0.5 w-5 h-5 bg-jasper-emerald text-white text-xs font-medium rounded-full flex items-center justify-center","aria-hidden":"true",children:p>9?"9+":p})]}),e&&(0,a.jsxs)("div",{role:"menu","aria-label":"Notifications menu",className:"absolute right-0 mt-2 w-96 bg-surface-primary rounded-lg shadow-lg border border-border z-50",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"font-semibold text-jasper-carbon",children:"Notifications"}),p>0&&(0,a.jsxs)("span",{className:"px-2 py-0.5 text-xs font-medium bg-jasper-emerald/10 text-jasper-emerald rounded-full",children:[p," new"]})]}),p>0&&(0,a.jsxs)("button",{onClick:g,className:"text-xs text-jasper-emerald hover:text-jasper-emerald-dark transition-colors flex items-center gap-1",children:[a.jsx(u.Z,{className:"w-3 h-3"}),"Mark all read"]})]}),a.jsx("div",{className:"max-h-96 overflow-y-auto",children:n?(0,a.jsxs)("div",{className:"p-8 text-center text-jasper-slate",children:[a.jsx(h.Z,{className:"w-8 h-8 mx-auto mb-2 animate-spin opacity-50"}),a.jsx("p",{className:"text-sm",children:"Loading notifications..."})]}):0===t.length?(0,a.jsxs)("div",{className:"p-8 text-center text-jasper-slate",children:[a.jsx(x.Z,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),a.jsx("p",{className:"text-sm",children:"No notifications yet"})]}):a.jsx("div",{className:"divide-y divide-border",children:t.map(e=>{let s=Z(e.type),t=C(e.type,e.priority);return(0,a.jsxs)("div",{role:"menuitem",tabIndex:0,"aria-label":`${e.title}: ${e.message}${e.isRead?"":" (unread)"}`,className:(0,b.cn)("relative p-4 hover:bg-surface-secondary transition-colors cursor-pointer group","focus:outline-none focus:ring-2 focus:ring-jasper-emerald focus:ring-inset",!e.isRead&&"bg-jasper-emerald/5"),onClick:()=>L(e),onKeyDown:s=>{("Enter"===s.key||" "===s.key)&&(s.preventDefault(),L(e))},children:[(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx("div",{className:(0,b.cn)("w-9 h-9 rounded-lg flex items-center justify-center flex-shrink-0",t),children:a.jsx(s,{className:"w-4 h-4"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[a.jsx("p",{className:(0,b.cn)("text-sm font-medium",e.isRead?"text-jasper-slate":"text-jasper-carbon"),children:e.title}),a.jsx("span",{className:"text-xs text-jasper-slate-light whitespace-nowrap flex-shrink-0",children:E(e.timestamp)})]}),a.jsx("p",{className:"text-sm text-jasper-slate mt-0.5 line-clamp-2",children:e.message})]}),!e.isRead&&a.jsx("div",{className:"w-2 h-2 rounded-full bg-jasper-emerald flex-shrink-0 mt-2"})]}),(0,a.jsxs)("div",{className:"absolute right-2 top-2 opacity-0 group-hover:opacity-100 transition-opacity flex gap-1",children:[!e.isRead&&a.jsx("button",{onClick:s=>{s.stopPropagation(),m(e.id)},className:"p-1.5 hover:bg-surface-tertiary rounded-md transition-colors",title:"Mark as read",children:a.jsx(f.Z,{className:"w-3.5 h-3.5 text-jasper-slate"})}),a.jsx("button",{onClick:s=>{s.stopPropagation(),$(e.id)},className:"p-1.5 hover:bg-red-50 rounded-md transition-colors",title:"Delete",children:a.jsx(j.Z,{className:"w-3.5 h-3.5 text-jasper-slate hover:text-red-500"})})]})]},e.id)})})}),t.length>0&&a.jsx("div",{className:"border-t border-border p-3",children:a.jsx("button",{onClick:S,className:"w-full text-sm text-jasper-slate hover:text-jasper-carbon transition-colors text-center",children:"Clear all notifications"})})]})]})}var S=t(9798),L=t(6283),D=t(8378),R=t(8307),T=t(3320),M=t(4230),q=t(8742);let z=[{id:"dashboard",title:"Dashboard",type:"page",href:"/",icon:S.Z},{id:"clients",title:"Clients",subtitle:"View all clients",type:"page",href:"/clients",icon:o.Z},{id:"projects",title:"Projects",subtitle:"View all projects",type:"page",href:"/projects",icon:c.Z},{id:"invoices",title:"Invoices",subtitle:"View all invoices",type:"page",href:"/invoices",icon:L.Z},{id:"settings",title:"Settings",subtitle:"Account preferences",type:"page",href:"/settings",icon:D.Z}],I={client:o.Z,project:c.Z,invoice:L.Z,page:S.Z},A={client:"bg-blue-100 text-blue-600",project:"bg-jasper-emerald/10 text-jasper-emerald",invoice:"bg-purple-100 text-purple-600",page:"bg-jasper-slate/10 text-jasper-slate"};function J({className:e}){let[s,t]=(0,i.useState)(!1),[r,n]=(0,i.useState)(""),[d,p]=(0,i.useState)(0),m=(0,i.useRef)(null),x=(0,l.useRouter)(),{data:u,isLoading:f}=(0,q.JE)({page:1,page_size:100}),{data:g,isLoading:y}=(0,q.Z0)({page:1,page_size:100}),{data:N,isLoading:v}=(0,q.qx)({page:1,page_size:100}),w=(()=>{if(!r.trim())return z;let e=[],s=r.toLowerCase();return(u?.companies||[]).filter(e=>e.name.toLowerCase().includes(s)||e.email?.toLowerCase().includes(s)).slice(0,3).forEach(s=>{e.push({id:`client-${s.id}`,title:s.name,subtitle:s.email||s.country,type:"client",href:`/clients/${s.id}`,icon:o.Z})}),(g?.projects||[]).filter(e=>e.name.toLowerCase().includes(s)||e.reference?.toLowerCase().includes(s)).slice(0,3).forEach(s=>{e.push({id:`project-${s.id}`,title:s.name,subtitle:s.reference,type:"project",href:`/projects/${s.id}`,icon:c.Z})}),(N?.invoices||[]).filter(e=>e.invoice_number?.toLowerCase().includes(s)).slice(0,3).forEach(s=>{e.push({id:`invoice-${s.id}`,title:s.invoice_number,subtitle:`${s.status} - ${s.currency} ${s.total}`,type:"invoice",href:`/invoices/${s.id}`,icon:L.Z})}),z.filter(e=>e.title.toLowerCase().includes(s)||e.subtitle?.toLowerCase().includes(s)).forEach(s=>e.push(s)),e})(),k=e=>{x.push(e.href),t(!1)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>t(!0),className:(0,b.cn)("flex items-center gap-2 px-3 py-2 text-sm text-jasper-slate rounded-lg","bg-surface-secondary hover:bg-surface-tertiary border border-border","transition-colors duration-200",e),children:[a.jsx(R.Z,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Search..."}),(0,a.jsxs)("kbd",{className:"hidden sm:inline-flex items-center gap-1 px-1.5 py-0.5 text-xs font-mono bg-surface-tertiary rounded border border-border-light",children:[a.jsx(T.Z,{className:"w-3 h-3"}),"K"]})]}),s&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50",children:[a.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>t(!1)}),a.jsx("div",{className:"relative flex items-start justify-center pt-[15vh] px-4",children:(0,a.jsxs)("div",{className:"w-full max-w-xl bg-surface-primary rounded-xl shadow-modal overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 px-4 py-3 border-b border-border",children:[a.jsx(R.Z,{className:"w-5 h-5 text-jasper-slate flex-shrink-0"}),a.jsx("input",{ref:m,type:"text",value:r,onChange:e=>{n(e.target.value),p(0)},onKeyDown:e=>{switch(e.key){case"ArrowDown":e.preventDefault(),p(e=>Math.min(e+1,w.length-1));break;case"ArrowUp":e.preventDefault(),p(e=>Math.max(e-1,0));break;case"Enter":e.preventDefault(),w[d]&&(x.push(w[d].href),t(!1))}},placeholder:"Search clients, projects, invoices...",className:"flex-1 bg-transparent text-jasper-carbon placeholder:text-jasper-slate-light focus:outline-none text-base"}),r&&a.jsx("button",{onClick:()=>n(""),className:"p-1 hover:bg-surface-secondary rounded",children:a.jsx(j.Z,{className:"w-4 h-4 text-jasper-slate"})})]}),a.jsx("div",{className:"max-h-[50vh] overflow-y-auto",children:(f||y||v)&&r?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx(h.Z,{className:"w-5 h-5 animate-spin text-jasper-slate"})}):0===w.length?a.jsx("div",{className:"py-8 text-center",children:(0,a.jsxs)("p",{className:"text-jasper-slate",children:['No results found for "',r,'"']})}):(0,a.jsxs)("div",{className:"py-2",children:[!r&&a.jsx("div",{className:"px-4 py-2 text-xs font-medium text-jasper-slate-light uppercase tracking-wider",children:"Quick Links"}),w.map((e,s)=>{let t=e.icon||I[e.type],r=A[e.type];return(0,a.jsxs)("button",{onClick:()=>k(e),onMouseEnter:()=>p(s),className:(0,b.cn)("w-full flex items-center gap-3 px-4 py-3 text-left transition-colors",d===s?"bg-jasper-emerald/5":"hover:bg-surface-secondary"),children:[a.jsx("div",{className:(0,b.cn)("w-9 h-9 rounded-lg flex items-center justify-center flex-shrink-0",r),children:a.jsx(t,{className:"w-4 h-4"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"font-medium text-jasper-carbon truncate",children:e.title}),e.subtitle&&a.jsx("div",{className:"text-sm text-jasper-slate truncate",children:e.subtitle})]}),d===s&&a.jsx(M.Z,{className:"w-4 h-4 text-jasper-emerald flex-shrink-0"})]},e.id)})]})}),(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border-t border-border bg-surface-secondary text-xs text-jasper-slate",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface-tertiary rounded",children:"↑"}),a.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface-tertiary rounded",children:"↓"}),"to navigate"]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface-tertiary rounded",children:"↵"}),"to select"]})]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface-tertiary rounded",children:"esc"}),"to close"]})]})]})})]})]})}var K=t(434),U=t(9183);function F({items:e,className:s,showHome:t=!0}){let r=t?[{label:"Dashboard",href:"/",icon:a.jsx(S.Z,{className:"w-4 h-4"})},...e]:e;return a.jsx("nav",{className:(0,b.cn)("flex items-center",s),"aria-label":"Breadcrumb",children:a.jsx("ol",{className:"flex items-center gap-1 text-sm",children:r.map((e,s)=>{let t=s===r.length-1,i=0===s;return(0,a.jsxs)("li",{className:"flex items-center gap-1",children:[!i&&a.jsx(U.Z,{className:"w-4 h-4 text-jasper-slate-light flex-shrink-0"}),t?(0,a.jsxs)("span",{className:"font-medium text-jasper-carbon truncate max-w-[200px]","aria-current":"page",children:[e.icon&&a.jsx("span",{className:"mr-1.5 inline-flex",children:e.icon}),e.label]}):e.href?(0,a.jsxs)(K.default,{href:e.href,className:"flex items-center gap-1.5 text-jasper-slate hover:text-jasper-emerald transition-colors",children:[e.icon,a.jsx("span",{className:(0,b.cn)(i&&!e.icon?"":"hidden sm:inline"),children:e.label})]}):(0,a.jsxs)("span",{className:"flex items-center gap-1.5 text-jasper-slate",children:[e.icon,a.jsx("span",{children:e.label})]})]},s)})})})}function O({title:e,subtitle:s,breadcrumbs:t}){return a.jsx("header",{className:"sticky top-0 z-30 bg-white border-b border-border",children:(0,a.jsxs)("div",{className:"flex items-center justify-between h-16 px-6",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[t&&t.length>0&&a.jsx(F,{items:t,className:"mb-1"}),e&&a.jsx("h1",{className:"text-xl font-semibold text-jasper-carbon",children:e}),s&&a.jsx("p",{className:"text-sm text-jasper-slate",children:s})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx(J,{className:"hidden md:flex"}),a.jsx($,{}),(0,a.jsxs)("button",{className:"flex items-center gap-3 p-2 hover:bg-surface-secondary rounded-lg transition-colors",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-jasper-emerald/10 flex items-center justify-center",children:a.jsx(r.Z,{className:"w-4 h-4 text-jasper-emerald"})}),(0,a.jsxs)("div",{className:"hidden md:flex flex-col items-start",children:[a.jsx("span",{className:"text-sm font-medium text-jasper-carbon",children:"Admin"}),a.jsx("span",{className:"text-xs text-jasper-slate",children:"admin@jasper.com"})]})]})]})]})})}t(2684)},8742:(e,s,t)=>{t.d(s,{JE:()=>l,Z0:()=>n,qx:()=>c});var a=t(108),r=t(2017);let i={companies:{all:["companies"],lists:()=>[...i.companies.all,"list"],list:e=>[...i.companies.lists(),e],details:()=>[...i.companies.all,"detail"],detail:e=>[...i.companies.details(),e]},projects:{all:["projects"],lists:()=>[...i.projects.all,"list"],list:e=>[...i.projects.lists(),e],details:()=>[...i.projects.all,"detail"],detail:e=>[...i.projects.details(),e],milestones:e=>[...i.projects.all,"milestones",e],timeline:e=>[...i.projects.all,"timeline",e]},invoices:{all:["invoices"],lists:()=>[...i.invoices.all,"list"],list:e=>[...i.invoices.lists(),e],details:()=>[...i.invoices.all,"detail"],detail:e=>[...i.invoices.details(),e]},dashboard:{all:["dashboard"],metrics:()=>[...i.dashboard.all,"metrics"],analytics:()=>[...i.dashboard.all,"analytics"]}};function l(e){return(0,a.a)({queryKey:i.companies.list(e),queryFn:()=>r.cv.list(e)})}function n(e){return(0,a.a)({queryKey:i.projects.list(e),queryFn:()=>r.qx.list(e)})}function c(e){return(0,a.a)({queryKey:i.invoices.list(e),queryFn:()=>r.iR.list(e)})}},3601:(e,s,t)=>{t.r(s),t.d(s,{default:()=>r});var a=t(6621);let r=e=>[{type:"image/png",sizes:"180x180",url:(0,a.fillMetadataSegment)(".",e.params,"apple-icon.png")+"?66aebdcff0815c5f"}]},1150:(e,s,t)=>{t.r(s),t.d(s,{default:()=>r});var a=t(6621);let r=e=>[{type:"image/png",sizes:"32x32",url:(0,a.fillMetadataSegment)(".",e.params,"icon.png")+"?ebae66276a929696"}]}};