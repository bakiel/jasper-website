(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[948],{5247:function(e,a,s){Promise.resolve().then(s.bind(s,8738))},2660:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(9205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1047:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(9205).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},9322:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(9205).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},2934:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(9205).Z)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},1723:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(9205).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},2735:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(9205).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},5868:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(9205).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},7689:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(9205).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},8738:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return V}});var t=s(7437),l=s(2265),r=s(9376),n=s(7648),c=s(1605),i=s(8736),d=s(9205);let o=(0,d.Z)("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]),m=(0,d.Z)("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]),p=(0,d.Z)("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);var x=s(1817),u=s(7689),h=s(9322),j=s(2489);let g=(0,d.Z)("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);var v=s(2735);let f=(0,d.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var b=s(5359),y=s(3448);let N={pdf:i.Z,doc:i.Z,docx:i.Z,xls:o,xlsx:o,csv:o,png:m,jpg:m,jpeg:m,gif:m},_={proposal:"Proposal",financial_model:"Financial Model",business_plan:"Business Plan",pitch_deck:"Pitch Deck",executive_summary:"Executive Summary",due_diligence:"Due Diligence",invoice:"Invoice",contract:"Contract",nda:"NDA",company_registration:"Company Registration",financial_statements:"Financial Statements",tax_documents:"Tax Documents",id_documents:"ID Documents",other_client:"Client Document",other_deliverable:"Deliverable"};function k(e){let{projectId:a,documents:s,onDocumentsChange:r,isAdmin:n=!0}=e,[c,i]=(0,l.useState)(!1),[d,o]=(0,l.useState)(null),[m,v]=(0,l.useState)(null),[f,_]=(0,l.useState)(null),[k,D]=(0,l.useState)(!1),C=(0,l.useRef)(null),[Z,P]=(0,l.useState)("other_client"),[S,F]=(0,l.useState)(""),M=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?D(!0):"dragleave"===e.type&&D(!1)},[]),q=(0,l.useCallback)(async e=>{e.preventDefault(),e.stopPropagation(),D(!1);let a=e.dataTransfer.files;a&&a.length>0&&await T(a[0])},[a,Z,S]),I=async e=>{let a=e.target.files;a&&a.length>0&&await T(a[0]),C.current&&(C.current.value="")},T=async e=>{v(null),i(!0),o("Uploading ".concat(e.name,"..."));try{let s=new FormData;s.append("file",e),s.append("project_id",a.toString()),s.append("document_type",Z),s.append("uploaded_by","admin"),s.append("is_client_upload","false"),S&&s.append("description",S),await b.Tg.upload(s),o(null),F(""),r()}catch(e){v(e instanceof Error?e.message:"Upload failed")}finally{i(!1),o(null)}},A=async e=>{if(confirm("Are you sure you want to delete this document?")){_(e);try{await b.Tg.delete(e),r()}catch(e){v(e instanceof Error?e.message:"Delete failed")}finally{_(null)}}},B=e=>{let a=b.Tg.download(e.id);window.open(a,"_blank")},E=e=>{if(0===e)return"0 B";let a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(1))+" "+["B","KB","MB","GB"][a]},R=e=>N[e.toLowerCase()]||p,U=s.filter(e=>["proposal","financial_model","business_plan","pitch_deck","executive_summary","due_diligence","invoice","other_deliverable"].includes(e.document_type)),z=s.filter(e=>!U.includes(e));return(0,t.jsxs)("div",{className:"space-y-6",children:[n&&(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"card-header",children:(0,t.jsx)("h3",{className:"font-semibold text-jasper-carbon",children:"Upload Document"})}),(0,t.jsxs)("div",{className:"card-body space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-jasper-carbon mb-1",children:"Document Type"}),(0,t.jsxs)("select",{value:Z,onChange:e=>P(e.target.value),className:"input w-full",children:[(0,t.jsxs)("optgroup",{label:"Deliverables",children:[(0,t.jsx)("option",{value:"proposal",children:"Proposal"}),(0,t.jsx)("option",{value:"financial_model",children:"Financial Model"}),(0,t.jsx)("option",{value:"business_plan",children:"Business Plan"}),(0,t.jsx)("option",{value:"pitch_deck",children:"Pitch Deck"}),(0,t.jsx)("option",{value:"executive_summary",children:"Executive Summary"}),(0,t.jsx)("option",{value:"due_diligence",children:"Due Diligence Report"}),(0,t.jsx)("option",{value:"invoice",children:"Invoice"}),(0,t.jsx)("option",{value:"other_deliverable",children:"Other Deliverable"})]}),(0,t.jsxs)("optgroup",{label:"Client Documents",children:[(0,t.jsx)("option",{value:"company_registration",children:"Company Registration"}),(0,t.jsx)("option",{value:"financial_statements",children:"Financial Statements"}),(0,t.jsx)("option",{value:"tax_documents",children:"Tax Documents"}),(0,t.jsx)("option",{value:"id_documents",children:"ID Documents"}),(0,t.jsx)("option",{value:"contract",children:"Contract"}),(0,t.jsx)("option",{value:"nda",children:"NDA"}),(0,t.jsx)("option",{value:"other_client",children:"Other Document"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-jasper-carbon mb-1",children:"Description (optional)"}),(0,t.jsx)("input",{type:"text",value:S,onChange:e=>F(e.target.value),placeholder:"Brief description...",className:"input w-full"})]})]}),(0,t.jsxs)("div",{onDragEnter:M,onDragLeave:M,onDragOver:M,onDrop:q,onClick:()=>{var e;return null===(e=C.current)||void 0===e?void 0:e.click()},className:(0,y.cn)("border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-all",k?"border-jasper-emerald bg-jasper-emerald/5":"border-border hover:border-jasper-emerald/50 hover:bg-surface-secondary"),children:[(0,t.jsx)("input",{ref:C,type:"file",className:"hidden",onChange:I,accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.png,.jpg,.jpeg,.gif,.txt,.csv"}),c?(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,t.jsx)(x.Z,{className:"w-8 h-8 text-jasper-emerald animate-spin"}),(0,t.jsx)("p",{className:"text-sm text-jasper-slate",children:d})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Z,{className:"w-8 h-8 text-jasper-slate mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-jasper-carbon font-medium",children:k?"Drop file here":"Click or drag file to upload"}),(0,t.jsx)("p",{className:"text-xs text-jasper-slate mt-1",children:"PDF, Word, Excel, PowerPoint, Images (max 50MB)"})]})]}),m&&(0,t.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 text-red-700 rounded-lg text-sm",children:[(0,t.jsx)(h.Z,{className:"w-4 h-4 flex-shrink-0"}),(0,t.jsx)("span",{children:m}),(0,t.jsx)("button",{onClick:()=>v(null),className:"ml-auto",children:(0,t.jsx)(j.Z,{className:"w-4 h-4"})})]})]})]}),(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"card-header flex items-center justify-between",children:(0,t.jsxs)("h3",{className:"font-semibold text-jasper-carbon",children:["Deliverables",(0,t.jsxs)("span",{className:"ml-2 text-sm font-normal text-jasper-slate",children:["(",U.length,")"]})]})}),0===U.length?(0,t.jsxs)("div",{className:"p-8 text-center text-jasper-slate",children:[(0,t.jsx)(g,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{className:"text-sm",children:"No deliverables uploaded yet"})]}):(0,t.jsx)("div",{className:"divide-y divide-border",children:U.map(e=>(0,t.jsx)(w,{document:e,onDownload:()=>B(e),onDelete:()=>A(e.id),deleting:f===e.id,isAdmin:n,formatFileSize:E,getFileIcon:R},e.id))})]}),(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"card-header flex items-center justify-between",children:(0,t.jsxs)("h3",{className:"font-semibold text-jasper-carbon",children:["Client Documents",(0,t.jsxs)("span",{className:"ml-2 text-sm font-normal text-jasper-slate",children:["(",z.length,")"]})]})}),0===z.length?(0,t.jsxs)("div",{className:"p-8 text-center text-jasper-slate",children:[(0,t.jsx)(g,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{className:"text-sm",children:"No client documents uploaded yet"})]}):(0,t.jsx)("div",{className:"divide-y divide-border",children:z.map(e=>(0,t.jsx)(w,{document:e,onDownload:()=>B(e),onDelete:()=>A(e.id),deleting:f===e.id,isAdmin:n,formatFileSize:E,getFileIcon:R},e.id))})]})]})}function w(e){let{document:a,onDownload:s,onDelete:l,deleting:r,isAdmin:n,formatFileSize:c,getFileIcon:i}=e,d=i(a.file_extension);return(0,t.jsxs)("div",{className:"p-4 flex items-center gap-4 hover:bg-surface-secondary/50 transition-colors",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-surface-secondary flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(d,{className:"w-5 h-5 text-jasper-emerald"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"font-medium text-jasper-carbon truncate",children:a.original_filename}),a.client_visible&&(0,t.jsx)("span",{className:"badge badge-success text-xs",children:"Visible"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 mt-1 text-xs text-jasper-slate",children:[(0,t.jsx)("span",{className:"badge badge-secondary",children:_[a.document_type]||a.document_type}),(0,t.jsx)("span",{children:c(a.file_size)}),(0,t.jsx)("span",{children:(0,y.p6)(a.uploaded_at)}),(0,t.jsxs)("span",{children:["by ",a.uploaded_by]})]}),a.description&&(0,t.jsx)("p",{className:"text-xs text-jasper-slate mt-1 truncate",children:a.description})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:s,className:"p-2 hover:bg-jasper-emerald/10 rounded-lg transition-colors group",title:"Download",children:(0,t.jsx)(v.Z,{className:"w-4 h-4 text-jasper-slate group-hover:text-jasper-emerald"})}),n&&(0,t.jsx)("button",{onClick:l,disabled:r,className:"p-2 hover:bg-red-50 rounded-lg transition-colors group disabled:opacity-50",title:"Delete",children:r?(0,t.jsx)(x.Z,{className:"w-4 h-4 text-red-500 animate-spin"}):(0,t.jsx)(f,{className:"w-4 h-4 text-jasper-slate group-hover:text-red-500"})})]})]})}var D=s(9597),C=s(2660),Z=s(2934),P=s(3417),S=s(5868),F=s(5252),M=s(8420),q=s(1047),I=s(1723);let T=(0,d.Z)("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var A=s(407),B=s(2051),E=s(1671),R=s(9827);let U=[{value:"startup",label:"Start-Up Package",price:"R45,000 - R75,000"},{value:"growth",label:"Growth Package",price:"R150,000 - R350,000"},{value:"enterprise",label:"Enterprise Package",price:"R500,000 - R750,000"},{value:"custom",label:"Custom Package",price:"Custom pricing"}],z=["Agriculture","Energy & Power","Infrastructure","Manufacturing","Mining","Real Estate","Technology","Transportation","Water & Sanitation","Healthcare","Education","Financial Services","Other"],H=[{value:"ZAR",label:"ZAR - South African Rand"},{value:"USD",label:"USD - US Dollar"},{value:"EUR",label:"EUR - Euro"},{value:"GBP",label:"GBP - British Pound"}],O=[{key:"inquiry",label:"Inquiry"},{key:"qualify",label:"Qualify"},{key:"intake",label:"Intake"},{key:"proposal",label:"Proposal"},{key:"deposit",label:"Deposit"},{key:"production",label:"Production"},{key:"draft",label:"Draft"},{key:"final",label:"Final"}];function V(){var e;let a=(0,r.useParams)();(0,r.useRouter)();let s=Number(a.id),[d,o]=(0,l.useState)(null),[m,p]=(0,l.useState)([]),[u,v]=(0,l.useState)([]),[f,N]=(0,l.useState)(!0),[_,w]=(0,l.useState)(!1),[V,Q]=(0,l.useState)(null),[K,W]=(0,l.useState)("overview"),[J,X]=(0,l.useState)(!1),[Y,$]=(0,l.useState)(!1),[ee,ea]=(0,l.useState)(""),[es,et]=(0,l.useState)(!1),[el,er]=(0,l.useState)({name:"",description:"",package:"",value:"",currency:"ZAR",target_completion:"",project_sector:"",project_location:"",funding_amount:"",target_dfis:""}),en=(0,R.NL)(),ec=async()=>{try{let[e,a,t]=await Promise.all([b.qx.get(s),b.qx.getMilestones(s).catch(()=>[]),b.Tg.listByProject(s).catch(()=>({documents:[],total:0}))]);o(e),p(a||[]),v(t.documents||[])}catch(e){console.error("Failed to fetch project:",e)}finally{N(!1)}},ei=async()=>{try{let e=await b.Tg.listByProject(s);v(e.documents||[])}catch(e){console.error("Failed to fetch documents:",e)}};(0,l.useEffect)(()=>{s&&ec()},[s]);let ed=async()=>{if(d){w(!0);try{let e=await b.qx.advanceStage(s);o(e)}catch(e){console.error("Failed to advance stage:",e)}finally{w(!1)}}},eo=async e=>{Q(e.id);try{let a=await b.qx.updateMilestone(s,e.id,{completed:!e.completed});p(s=>s.map(s=>s.id===e.id?a:s));let t=await b.qx.get(s);o(t)}catch(e){console.error("Failed to update milestone:",e)}finally{Q(null)}},em=()=>{if(d){var e;er({name:d.name||"",description:d.description||"",package:d.package||"",value:d.value||"",currency:d.currency||"ZAR",target_completion:d.target_completion?d.target_completion.split("T")[0]:"",project_sector:d.project_sector||"",project_location:d.project_location||"",funding_amount:d.funding_amount||"",target_dfis:(null===(e=d.target_dfis)||void 0===e?void 0:e.join(", "))||""}),ea(""),et(!1),X(!0)}},ep=e=>{let{name:a,value:s}=e.target;er(e=>({...e,[a]:"value"===a||"funding_amount"===a?""===s?"":Number(s):s}))},ex=async e=>{e.preventDefault(),$(!0),ea(""),et(!1);try{let e={name:el.name,description:el.description||null,package:el.package,value:el.value||null,currency:el.currency,target_completion:el.target_completion||null,project_sector:el.project_sector||null,project_location:el.project_location||null,funding_amount:el.funding_amount||null,target_dfis:el.target_dfis?el.target_dfis.split(",").map(e=>e.trim()).filter(e=>e):null},a=await b.qx.update(s,e);o(a),et(!0),en.invalidateQueries({queryKey:["projects"]}),setTimeout(()=>{X(!1),et(!1)},1500)}catch(e){var a,t;console.error("Failed to update project:",e),ea((null===(t=e.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.detail)||"Failed to update project")}finally{$(!1)}},eu=()=>{Y||(X(!1),ea(""),et(!1))},eh=d?O.findIndex(e=>e.key===d.stage):-1;if(f)return(0,t.jsx)("div",{className:"min-h-screen bg-surface-secondary flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-pulse text-jasper-slate",children:"Loading project..."})});if(!d)return(0,t.jsx)("div",{className:"min-h-screen bg-surface-secondary flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-jasper-slate mb-4",children:"Project not found"}),(0,t.jsx)(n.default,{href:"/projects",className:"btn-primary",children:"Back to Projects"})]})});let ej=m.filter(e=>e.completed).length,eg=m.length;return(0,t.jsxs)("div",{className:"min-h-screen bg-surface-secondary",children:[(0,t.jsx)(c.h4,{title:d.reference,subtitle:d.name}),(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)(n.default,{href:"/projects",className:"inline-flex items-center gap-2 text-sm text-jasper-slate hover:text-jasper-carbon transition-colors",children:[(0,t.jsx)(C.Z,{className:"w-4 h-4"}),"Back to Projects"]}),(0,t.jsx)("div",{className:"card",children:(0,t.jsx)("div",{className:"card-body",children:(0,t.jsx)("div",{className:"flex items-center justify-between overflow-x-auto pb-2",children:O.map((e,a)=>{let s=a<eh,l=a===eh;return(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center min-w-[80px]",children:[(0,t.jsx)("div",{className:(0,y.cn)("w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium transition-all",s&&"bg-jasper-emerald text-white",l&&"bg-jasper-emerald text-white ring-4 ring-jasper-emerald/20",a>eh&&"bg-surface-tertiary text-jasper-slate"),children:s?(0,t.jsx)(Z.Z,{className:"w-4 h-4"}):a+1}),(0,t.jsx)("span",{className:(0,y.cn)("mt-2 text-xs font-medium whitespace-nowrap",l?"text-jasper-emerald":"text-jasper-slate"),children:e.label})]}),a<O.length-1&&(0,t.jsx)("div",{className:(0,y.cn)("w-12 h-0.5 mx-1",a<eh?"bg-jasper-emerald":"bg-surface-tertiary")})]},e.key)})})})}),(0,t.jsxs)("div",{className:"flex gap-1 border-b border-border",children:[(0,t.jsx)("button",{onClick:()=>W("overview"),className:(0,y.cn)("px-4 py-2 text-sm font-medium border-b-2 transition-colors","overview"===K?"border-jasper-emerald text-jasper-emerald":"border-transparent text-jasper-slate hover:text-jasper-carbon"),children:"Overview"}),(0,t.jsxs)("button",{onClick:()=>W("documents"),className:(0,y.cn)("px-4 py-2 text-sm font-medium border-b-2 transition-colors flex items-center gap-2","documents"===K?"border-jasper-emerald text-jasper-emerald":"border-transparent text-jasper-slate hover:text-jasper-carbon"),children:[(0,t.jsx)(g,{className:"w-4 h-4"}),"Documents",u.length>0&&(0,t.jsx)("span",{className:"badge badge-secondary text-xs",children:u.length})]}),(0,t.jsxs)("button",{onClick:()=>W("messages"),className:(0,y.cn)("px-4 py-2 text-sm font-medium border-b-2 transition-colors flex items-center gap-2","messages"===K?"border-jasper-emerald text-jasper-emerald":"border-transparent text-jasper-slate hover:text-jasper-carbon"),children:[(0,t.jsx)(P.Z,{className:"w-4 h-4"}),"Messages"]})]}),"overview"===K&&(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,t.jsxs)("div",{className:"card",children:[(0,t.jsxs)("div",{className:"card-header flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-jasper-carbon",children:"Project Overview"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:(0,y.cn)("badge text-sm",(0,y.ul)(d.stage)),children:(0,y.im)(d.stage)}),(0,t.jsx)("button",{onClick:em,className:"p-2 hover:bg-surface-secondary rounded-lg transition-colors",title:"Edit Project",children:(0,t.jsx)(S.Z,{className:"w-4 h-4 text-jasper-slate"})})]})]}),(0,t.jsxs)("div",{className:"card-body",children:[d.description&&(0,t.jsx)("p",{className:"text-jasper-slate mb-6",children:d.description}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[(0,t.jsx)(L,{icon:F.Z,label:"Value",value:(0,y.xG)(d.value,d.currency)}),(0,t.jsx)(L,{icon:M.Z,label:"Package",value:(0,y.IS)(d.package)}),(0,t.jsx)(L,{icon:q.Z,label:"Target Date",value:d.target_completion?(0,y.p6)(d.target_completion):"-"}),(0,t.jsx)(L,{icon:I.Z,label:"Revisions",value:"".concat(d.revision_rounds_used,"/").concat(d.revision_rounds_total)})]}),(0,t.jsxs)("div",{className:"mt-6 pt-6 border-t border-border",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-jasper-carbon",children:"Overall Progress"}),(0,t.jsxs)("span",{className:"text-sm font-semibold text-jasper-emerald",children:[d.progress_percent,"%"]})]}),(0,t.jsx)("div",{className:"h-3 bg-surface-tertiary rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-gradient-to-r from-jasper-emerald to-jasper-emerald-light rounded-full transition-all duration-700",style:{width:"".concat(d.progress_percent,"%")}})})]})]})]}),(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"card-header flex items-center justify-between",children:(0,t.jsxs)("h2",{className:"text-lg font-semibold text-jasper-carbon",children:["Milestones",(0,t.jsxs)("span",{className:"ml-2 text-sm font-normal text-jasper-slate",children:["(",ej,"/",eg," completed)"]})]})}),(0,t.jsx)("div",{className:"divide-y divide-border",children:0===m.length?(0,t.jsx)("div",{className:"p-6 text-center text-jasper-slate",children:"No milestones defined yet"}):m.map((e,a)=>(0,t.jsxs)("div",{className:(0,y.cn)("p-4 flex items-start gap-4 group transition-colors",e.completed&&"bg-surface-secondary/50"),children:[(0,t.jsx)("button",{onClick:()=>eo(e),disabled:V===e.id,className:"flex-shrink-0 mt-0.5 disabled:opacity-50",children:V===e.id?(0,t.jsx)(x.Z,{className:"w-5 h-5 text-jasper-emerald animate-spin"}):e.completed?(0,t.jsx)(Z.Z,{className:"w-5 h-5 text-jasper-emerald hover:text-jasper-emerald-dark transition-colors"}):(0,t.jsx)(T,{className:"w-5 h-5 text-jasper-slate-light hover:text-jasper-emerald transition-colors"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:(0,y.cn)("font-medium",e.completed?"text-jasper-slate line-through":"text-jasper-carbon"),children:e.name}),(0,t.jsxs)("span",{className:"text-xs text-jasper-slate-light",children:["#",e.order]})]}),e.description&&(0,t.jsx)("p",{className:"text-sm text-jasper-slate mt-1",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-xs text-jasper-slate",children:[e.due_date&&(0,t.jsxs)("span",{className:(0,y.cn)("flex items-center gap-1",!e.completed&&new Date(e.due_date)<new Date&&"text-red-500"),children:[(0,t.jsx)(q.Z,{className:"w-3 h-3"}),"Due: ",(0,y.p6)(e.due_date),!e.completed&&new Date(e.due_date)<new Date&&" (Overdue)"]}),e.completed_date&&(0,t.jsxs)("span",{className:"flex items-center gap-1 text-jasper-emerald",children:[(0,t.jsx)(Z.Z,{className:"w-3 h-3"}),"Completed: ",(0,y.p6)(e.completed_date)]})]})]})]},e.id))})]}),(d.project_sector||d.project_location||d.funding_amount||(null===(e=d.target_dfis)||void 0===e?void 0:e.length))&&(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"card-header",children:(0,t.jsx)("h2",{className:"text-lg font-semibold text-jasper-carbon",children:"Project Details"})}),(0,t.jsx)("div",{className:"card-body",children:(0,t.jsxs)("dl",{className:"grid grid-cols-2 gap-4",children:[d.project_sector&&(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm text-jasper-slate",children:"Sector"}),(0,t.jsx)("dd",{className:"font-medium text-jasper-carbon",children:d.project_sector})]}),d.project_location&&(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm text-jasper-slate",children:"Location"}),(0,t.jsx)("dd",{className:"font-medium text-jasper-carbon",children:d.project_location})]}),d.funding_amount&&(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm text-jasper-slate",children:"Funding Target"}),(0,t.jsx)("dd",{className:"font-medium text-jasper-carbon",children:(0,y.xG)(d.funding_amount,d.currency)})]}),d.target_dfis&&d.target_dfis.length>0&&(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsx)("dt",{className:"text-sm text-jasper-slate mb-2",children:"Target DFIs"}),(0,t.jsx)("dd",{className:"flex flex-wrap gap-2",children:d.target_dfis.map(e=>(0,t.jsx)("span",{className:"badge badge-info",children:e},e))})]})]})})]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"card-header",children:(0,t.jsx)("h3",{className:"font-semibold text-jasper-carbon",children:"Quick Actions"})}),(0,t.jsxs)("div",{className:"card-body space-y-2",children:[(0,t.jsxs)("button",{onClick:ed,disabled:_||"final"===d.stage,className:"btn-primary w-full justify-start disabled:opacity-50",children:[_?(0,t.jsx)(x.Z,{className:"w-4 h-4 animate-spin"}):(0,t.jsx)(A.Z,{className:"w-4 h-4"}),_?"Advancing...":"final"===d.stage?"Project Complete":"Advance Stage"]}),(0,t.jsxs)("button",{className:"btn-secondary w-full justify-start",children:[(0,t.jsx)(i.Z,{className:"w-4 h-4"}),"Create Invoice"]}),(0,t.jsxs)("button",{onClick:()=>W("documents"),className:"btn-ghost w-full justify-start",children:[(0,t.jsx)(g,{className:"w-4 h-4"}),"Manage Documents"]}),(0,t.jsxs)("button",{onClick:em,className:"btn-ghost w-full justify-start",children:[(0,t.jsx)(S.Z,{className:"w-4 h-4"}),"Edit Project"]})]})]}),(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"card-header",children:(0,t.jsx)("h3",{className:"font-semibold text-jasper-carbon",children:"Timeline"})}),(0,t.jsx)("div",{className:"card-body",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(G,{label:"Inquiry Date",date:d.inquiry_date,completed:!0}),d.start_date&&(0,t.jsx)(G,{label:"Start Date",date:d.start_date,completed:!0}),d.target_completion&&(0,t.jsx)(G,{label:"Target Completion",date:d.target_completion,completed:!!d.actual_completion}),d.actual_completion&&(0,t.jsx)(G,{label:"Actual Completion",date:d.actual_completion,completed:!0,highlight:!0})]})})]}),(0,t.jsx)("div",{className:"card",children:(0,t.jsxs)("div",{className:"card-body text-sm text-jasper-slate space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Created"}),(0,t.jsx)("span",{className:"text-jasper-carbon",children:(0,y.p6)(d.created_at)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Last Updated"}),(0,t.jsx)("span",{className:"text-jasper-carbon",children:(0,y.p6)(d.updated_at)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Project ID"}),(0,t.jsxs)("span",{className:"font-mono text-jasper-carbon",children:["#",d.id]})]})]})})]})]}),"documents"===K&&(0,t.jsx)(k,{projectId:s,documents:u,onDocumentsChange:ei,isAdmin:!0}),"messages"===K&&d&&(0,t.jsx)("div",{className:"h-[600px]",children:(0,t.jsx)(D.p,{companyId:d.company_id,companyName:d.company_name,projectId:s})})]}),J&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-surface-primary rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-jasper-emerald/10 flex items-center justify-center",children:(0,t.jsx)(B.Z,{className:"w-5 h-5 text-jasper-emerald"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-jasper-carbon",children:"Edit Project"}),(0,t.jsx)("p",{className:"text-sm text-jasper-slate",children:d.reference})]})]}),(0,t.jsx)("button",{onClick:eu,className:"p-2 hover:bg-surface-secondary rounded-lg transition-colors",children:(0,t.jsx)(j.Z,{className:"w-5 h-5 text-jasper-slate"})})]}),(0,t.jsxs)("form",{onSubmit:ex,className:"p-6",children:[es&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-3",children:[(0,t.jsx)(E.Z,{className:"w-5 h-5 text-green-600"}),(0,t.jsx)("span",{className:"text-green-700",children:"Project updated successfully!"})]}),ee&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3",children:[(0,t.jsx)(h.Z,{className:"w-5 h-5 text-red-600"}),(0,t.jsx)("span",{className:"text-red-700",children:ee})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-jasper-carbon mb-4",children:"Basic Information"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"name",className:"input-label",children:"Project Name *"}),(0,t.jsx)("input",{type:"text",id:"name",name:"name",value:el.name,onChange:ep,className:"input",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"description",className:"input-label",children:"Description"}),(0,t.jsx)("textarea",{id:"description",name:"description",value:el.description,onChange:ep,rows:3,className:"input resize-none",placeholder:"Brief description of the project..."})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-jasper-carbon mb-4",children:"Package & Value"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"package",className:"input-label",children:"Package *"}),(0,t.jsxs)("select",{id:"package",name:"package",value:el.package,onChange:ep,className:"input",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Select package..."}),U.map(e=>(0,t.jsxs)("option",{value:e.value,children:[e.label," (",e.price,")"]},e.value))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"currency",className:"input-label",children:"Currency"}),(0,t.jsx)("select",{id:"currency",name:"currency",value:el.currency,onChange:ep,className:"input",children:H.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"value",className:"input-label",children:"Project Value"}),(0,t.jsx)("input",{type:"number",id:"value",name:"value",value:el.value,onChange:ep,className:"input",min:"0",step:"0.01",placeholder:"0.00"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"target_completion",className:"input-label",children:"Target Completion"}),(0,t.jsx)("input",{type:"date",id:"target_completion",name:"target_completion",value:el.target_completion,onChange:ep,className:"input"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-jasper-carbon mb-4",children:"Project Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"project_sector",className:"input-label",children:"Sector"}),(0,t.jsxs)("select",{id:"project_sector",name:"project_sector",value:el.project_sector,onChange:ep,className:"input",children:[(0,t.jsx)("option",{value:"",children:"Select sector..."}),z.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"project_location",className:"input-label",children:"Location"}),(0,t.jsx)("input",{type:"text",id:"project_location",name:"project_location",value:el.project_location,onChange:ep,className:"input",placeholder:"City, Country"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"funding_amount",className:"input-label",children:"Funding Target"}),(0,t.jsx)("input",{type:"number",id:"funding_amount",name:"funding_amount",value:el.funding_amount,onChange:ep,className:"input",min:"0",step:"0.01",placeholder:"0.00"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"target_dfis",className:"input-label",children:"Target DFIs"}),(0,t.jsx)("input",{type:"text",id:"target_dfis",name:"target_dfis",value:el.target_dfis,onChange:ep,className:"input",placeholder:"AfDB, IFC, DBSA (comma-separated)"})]})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 mt-8 pt-6 border-t border-border",children:[(0,t.jsx)("button",{type:"button",onClick:eu,className:"btn-secondary",disabled:Y,children:"Cancel"}),(0,t.jsx)("button",{type:"submit",className:"btn-primary",disabled:Y||!el.name||!el.package,children:Y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Z,{className:"w-4 h-4 animate-spin"}),"Updating..."]}):"Update Project"})]})]})]})})]})}function L(e){let{icon:a,label:s,value:l}=e;return(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-surface-secondary flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(a,{className:"w-5 h-5 text-jasper-emerald"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-jasper-slate",children:s}),(0,t.jsx)("p",{className:"font-medium text-jasper-carbon",children:l})]})]})}function G(e){let{label:a,date:s,completed:l,highlight:r}=e;return(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:(0,y.cn)("w-3 h-3 rounded-full",l?r?"bg-jasper-emerald":"bg-jasper-slate":"bg-surface-tertiary border-2 border-jasper-slate-light")}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm text-jasper-slate",children:a}),(0,t.jsx)("p",{className:(0,y.cn)("font-medium",r?"text-jasper-emerald":"text-jasper-carbon"),children:(0,y.p6)(s)})]})]})}}},function(e){e.O(0,[145,197,828,797,412,766,213,605,597,971,117,744],function(){return e(e.s=5247)}),_N_E=e.O()}]);